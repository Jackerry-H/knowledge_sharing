<mxfile host="app.diagrams.net" modified="2023-11-09T03:26:27.556Z" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36" etag="y6Hc_vj__Bt-mwyaxvBk" version="21.7.2" type="github" pages="2">
  <diagram id="C5RBs43oDa-KdzZeNtuy" name="Page-1">
    <mxGraphModel dx="4977" dy="4112" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-1" parent="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-116" value="" style="group" vertex="1" connectable="0" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="-1480" y="620" width="2721" height="680" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-113" value="" style="rounded=0;whiteSpace=wrap;html=1;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-116">
          <mxGeometry x="1355" y="280" width="1185" height="400" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-18" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;query = &quot;我想找智慧经营流水表&quot;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-116">
          <mxGeometry x="91" y="180" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-68" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-116" source="nESsYgASZ1RXGsbO0uEQ-19" target="nESsYgASZ1RXGsbO0uEQ-18">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-19" value="Actor" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-116">
          <mxGeometry y="180" width="30" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-41" value="1.2 解析到 destination为 chat 或者是 default" style="whiteSpace=wrap;html=1;align=left;rounded=1;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-116">
          <mxGeometry x="1126" y="180" width="180" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-89" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-116" source="nESsYgASZ1RXGsbO0uEQ-67">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1426" y="415" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-67" value="1.3 解析到 destination为 sql 或者是 default" style="whiteSpace=wrap;html=1;align=left;rounded=1;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-116">
          <mxGeometry x="1121" y="380" width="190" height="70" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-69" value="Route 子任务" style="whiteSpace=wrap;html=1;fontSize=16;rounded=1;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-116">
          <mxGeometry x="255" y="180" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-70" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-116" source="nESsYgASZ1RXGsbO0uEQ-18" target="nESsYgASZ1RXGsbO0uEQ-69">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-77" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-116" source="nESsYgASZ1RXGsbO0uEQ-71" target="nESsYgASZ1RXGsbO0uEQ-41">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-78" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-116" source="nESsYgASZ1RXGsbO0uEQ-71" target="nESsYgASZ1RXGsbO0uEQ-67">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-71" value="{&lt;br style=&quot;font-size: 16px;&quot;&gt;&amp;nbsp; &amp;nbsp; &quot;destination&quot;: &quot;index&quot;&lt;br style=&quot;font-size: 16px;&quot;&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;span style=&quot;background-color: initial; font-size: 16px;&quot;&gt;&amp;nbsp; &amp;nbsp; &quot;next_inputs&quot;: &quot;我想找智慧经营流水表&quot;&lt;/span&gt;&lt;/div&gt;}" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-116">
          <mxGeometry x="541" y="150" width="270" height="120" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-73" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-116" source="nESsYgASZ1RXGsbO0uEQ-69" target="nESsYgASZ1RXGsbO0uEQ-71">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="471" y="210" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-74" value="1.模型响应结果" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-116">
          <mxGeometry x="381" y="180" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-75" value="1.1 解析到destination 为index，调用index任务找表" style="whiteSpace=wrap;html=1;align=left;rounded=1;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-116">
          <mxGeometry x="1121" width="195" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-76" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-116" source="nESsYgASZ1RXGsbO0uEQ-71" target="nESsYgASZ1RXGsbO0uEQ-75">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-79" value="根据结果路由到下游子任务中的一个" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-116">
          <mxGeometry x="851" y="120" width="100" height="100" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-82" value="根据sessionID查询历史对话记录，封装chat_history, 调用模型进行回答" style="whiteSpace=wrap;html=1;fontSize=16;align=left;rounded=1;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-116">
          <mxGeometry x="1371" y="150" width="265" height="120" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-83" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-116" source="nESsYgASZ1RXGsbO0uEQ-41" target="nESsYgASZ1RXGsbO0uEQ-82">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-84" value="Chat子任务" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-116">
          <mxGeometry x="1451" y="120" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-86" value="结果" style="rounded=1;whiteSpace=wrap;html=1;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-116">
          <mxGeometry x="2601" y="180" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-87" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-116" source="nESsYgASZ1RXGsbO0uEQ-75" target="nESsYgASZ1RXGsbO0uEQ-86">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-85" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-116" source="nESsYgASZ1RXGsbO0uEQ-82" target="nESsYgASZ1RXGsbO0uEQ-86">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1731" y="-59.999999999999545" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-90" value="sql子任务" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-116">
          <mxGeometry x="1910" y="280" width="129" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-91" value="获取sessionID的历史对话" style="rounded=1;whiteSpace=wrap;html=1;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-116">
          <mxGeometry x="1361" y="385" width="190" height="55" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-92" value="判断对话中最近一条结果是否是index结果" style="rhombus;whiteSpace=wrap;html=1;rounded=1;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-116">
          <mxGeometry x="1641" y="321.25" width="310" height="182.5" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-93" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-116" source="nESsYgASZ1RXGsbO0uEQ-91" target="nESsYgASZ1RXGsbO0uEQ-92">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-94" value="取最后一条对话记录封装chat_history，并解析index结果中的表,根据表名来获取表的schema，组装" style="whiteSpace=wrap;html=1;rounded=1;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-116">
          <mxGeometry x="2111" y="343.75" width="160" height="137.5" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-95" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-116" source="nESsYgASZ1RXGsbO0uEQ-92" target="nESsYgASZ1RXGsbO0uEQ-94">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-96" value="是" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-116">
          <mxGeometry x="1971" y="385" width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-104" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.75;entryDx=0;entryDy=0;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-116" source="nESsYgASZ1RXGsbO0uEQ-101" target="nESsYgASZ1RXGsbO0uEQ-94">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-101" value="先根据问题去index任务找表" style="whiteSpace=wrap;html=1;fontSize=16;rounded=1;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-116">
          <mxGeometry x="1736" y="610" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-102" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-116" source="nESsYgASZ1RXGsbO0uEQ-92" target="nESsYgASZ1RXGsbO0uEQ-101">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-103" value="否" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-116">
          <mxGeometry x="1751" y="548" width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-110" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-116" source="nESsYgASZ1RXGsbO0uEQ-108" target="nESsYgASZ1RXGsbO0uEQ-86">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-108" value="调用模型进行豁达" style="whiteSpace=wrap;html=1;fontSize=16;rounded=1;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-116">
          <mxGeometry x="2371" y="382.5" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-109" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-116" source="nESsYgASZ1RXGsbO0uEQ-94" target="nESsYgASZ1RXGsbO0uEQ-108">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-117" value="" style="group" vertex="1" connectable="0" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="-1120" y="-1210" width="2220" height="1690" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-117" target="nESsYgASZ1RXGsbO0uEQ-6">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="750" y="1150" as="sourcePoint" />
            <mxPoint x="1240" y="1397.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-0" value="MULTI_PROMPT_ROUTER_TEMPLATE = &quot;&quot;&quot;\&#xa;Given a raw text input to a language model select the model prompt best suited for \&#xa;the input. You will be given the names of the available prompts and a description of \&#xa;what the prompt is best suited for. You may also revise the original input if you \&#xa;think that revising it will ultimately lead to a better response from the language \&#xa;model.&#xa;&#xa;&lt;&lt; FORMATTING &gt;&gt;&#xa;Return a markdown code snippet with a JSON object formatted to look like:&#xa;```json&#xa;{{{{&#xa;&quot;destination&quot;: string \\ name of the prompt to use or &quot;DEFAULT&quot;&#xa;&quot;next_inputs&quot;: string \\ a potentially modified version of the original input&#xa;}}}}&#xa;```&#xa;&#xa;REMEMBER: &quot;destination&quot; MUST be one of the candidate prompt names specified below OR \&#xa;it can be &quot;DEFAULT&quot; if the input is not well suited for any of the candidate prompts.&#xa;REMEMBER: &quot;next_inputs&quot; can just be the original input if you don&#39;t think any \&#xa;modifications are needed.&#xa;&#xa;&lt;&lt; CANDIDATE PROMPTS &gt;&gt;&#xa;{destinations}&#xa;&#xa;&lt;&lt; INPUT &gt;&gt;&#xa;{{input}}&#xa;&#xa;&lt;&lt; OUTPUT &gt;&gt;&#xa;&quot;&quot;&quot;&#xa;" style="rounded=1;whiteSpace=wrap;hachureGap=4;fontFamily=Times New Roman;fontSize=16;align=left;spacingLeft=17;spacingTop=10;spacingBottom=-10;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-117">
          <mxGeometry y="1040" width="750" height="650" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-1" value="&lt;p style=&quot;line-height: 80%; font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;sql_template=&quot;&quot;&quot;&lt;/font&gt;You are a SQL export, you should based on the table&#39;s schema and chat history below , write a sql query that would answer the user&#39;s question:&lt;/p&gt;&lt;p style=&quot;line-height: 80%; font-size: 16px;&quot;&gt;Chat History:&lt;/p&gt;&lt;p style=&quot;line-height: 80%; font-size: 16px;&quot;&gt;{chat_history}&lt;/p&gt;&lt;p style=&quot;line-height: 80%; font-size: 16px;&quot;&gt;&lt;br style=&quot;font-size: 16px;&quot;&gt;&lt;/p&gt;&lt;p style=&quot;line-height: 80%; font-size: 16px;&quot;&gt;Table Schema:&lt;/p&gt;&lt;p style=&quot;line-height: 80%; font-size: 16px;&quot;&gt;{schema}&lt;/p&gt;&lt;p style=&quot;line-height: 80%; font-size: 16px;&quot;&gt;&lt;br style=&quot;font-size: 16px;&quot;&gt;&lt;/p&gt;&lt;p style=&quot;line-height: 80%; font-size: 16px;&quot;&gt;Question:{question}&lt;/p&gt;&lt;p style=&quot;line-height: 80%; font-size: 16px;&quot;&gt;&lt;span style=&quot;background-color: initial; font-size: 16px;&quot;&gt;SQL Query:&lt;/span&gt;&lt;span style=&quot;font-size: 16px; background-color: initial;&quot;&gt;&quot;&quot;&quot;&lt;/span&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;hachureGap=4;fontFamily=Times New Roman;fontSize=16;align=left;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-117">
          <mxGeometry x="15" y="350" width="900" height="350" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-2" value="&lt;p style=&quot;line-height: 80%; font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;chat_template=&quot;&quot;&quot;&lt;/font&gt;You are a chatbot with a human and an AI. you should consider the current conversation to answer the question. If the AI does not know the answer to a question, it truthfully says it does not know. and answer in chinese.&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;line-height: 80%; font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;Current conversation:&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;line-height: 80%; font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;{chat_history}&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;line-height: 80%; font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;Human: {human_input}&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;line-height: 80%; font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;span style=&quot;background-color: initial; font-size: 16px;&quot;&gt;AI:&lt;/span&gt;&lt;span style=&quot;background-color: initial; font-size: 16px;&quot;&gt;&quot;&quot;&quot;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;hachureGap=4;fontFamily=Times New Roman;fontSize=16;align=left;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-117">
          <mxGeometry x="20" y="100" width="890" height="210" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-4" value="&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;chat: Mainly used for daily communication, such as greetings, chatting, etc.&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;index: Used when the problem involves requirements related to finding tables and fields.&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;sql: Used when a question is related to SQL, such as generate sql and other.&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-117">
          <mxGeometry y="820" width="750" height="180" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-5" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;destination_str&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-117">
          <mxGeometry x="293" y="820" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-6" value="&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;Given a raw text input to a language model select the model prompt best suited for the input. You will be given the names of the available prompts and a description of what the prompt is best suited for. You may also revise the original input if you think that revising it will ultimately lead to a better response from the language model.&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;br style=&quot;font-size: 16px;&quot;&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;&amp;lt;&amp;lt; FORMATTING &amp;gt;&amp;gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;Return a markdown code snippet with a JSON object formatted to look like:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;```json&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;{&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;&amp;nbsp; &amp;nbsp; &quot;destination&quot;: string \\ name of the prompt to use or &quot;DEFAULT&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;&amp;nbsp; &amp;nbsp; &quot;next_inputs&quot;: string \\ a potentially modified version of the original input&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;}&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;```&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;br style=&quot;font-size: 16px;&quot;&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;REMEMBER: &quot;destination&quot; MUST be one of the candidate prompt names specified below OR it can be &quot;DEFAULT&quot; if the input is not well suited for any of the candidate prompts.&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;REMEMBER: &quot;next_inputs&quot; can just be the original input if you don&#39;t think any modifications are needed.&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;br style=&quot;font-size: 16px;&quot;&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;&amp;lt;&amp;lt; CANDIDATE PROMPTS &amp;gt;&amp;gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;chat: Mainly used for daily communication, such as greetings, chatting, etc.&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;index: Used when the problem involves requirements related to finding tables and fields.&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;sql: Used when a question is related to SQL, such as generate sql and other.&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;br style=&quot;font-size: 16px;&quot;&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;br style=&quot;font-size: 16px;&quot;&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;&amp;lt;&amp;lt; INPUT &amp;gt;&amp;gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;{input}&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;br style=&quot;font-size: 16px;&quot;&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;&amp;lt;&amp;lt; OUTPUT &amp;gt;&amp;gt;&lt;/font&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;align=left;rounded=1;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-117">
          <mxGeometry x="980" y="940" width="960" height="660" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-7" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-117" source="nESsYgASZ1RXGsbO0uEQ-4" target="nESsYgASZ1RXGsbO0uEQ-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-9" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;router_prompt&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-117">
          <mxGeometry x="1580" y="940" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-10" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;index 子任务&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-117">
          <mxGeometry x="20" width="880" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-11" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;index 任务&lt;/font&gt;" style="whiteSpace=wrap;html=1;rounded=1;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-117">
          <mxGeometry x="1790" y="10" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-12" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-117" source="nESsYgASZ1RXGsbO0uEQ-10" target="nESsYgASZ1RXGsbO0uEQ-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-13" value="chat prompt" style="whiteSpace=wrap;html=1;fontSize=16;fontFamily=Times New Roman;align=center;rounded=1;hachureGap=4;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-117">
          <mxGeometry x="1280" y="175" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-14" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-117" source="nESsYgASZ1RXGsbO0uEQ-2" target="nESsYgASZ1RXGsbO0uEQ-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-15" value="&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;span style=&quot;background-color: initial; font-size: 16px;&quot;&gt;sql_prompt&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;fontSize=16;fontFamily=Times New Roman;align=center;rounded=1;hachureGap=4;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-117">
          <mxGeometry x="1280" y="495" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-16" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-117" source="nESsYgASZ1RXGsbO0uEQ-1" target="nESsYgASZ1RXGsbO0uEQ-15">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-17" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;同时这个也是默认&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-117">
          <mxGeometry x="1680" y="250" width="210" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-22" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;chatglm&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-117">
          <mxGeometry x="1540" y="720" width="210" height="56" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-23" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;route 任务&lt;/font&gt;" style="whiteSpace=wrap;html=1;rounded=1;fontSize=16;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-117">
          <mxGeometry x="2100" y="1000" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-32" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-117" source="nESsYgASZ1RXGsbO0uEQ-6" target="nESsYgASZ1RXGsbO0uEQ-23">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-33" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-117" source="nESsYgASZ1RXGsbO0uEQ-22" target="nESsYgASZ1RXGsbO0uEQ-23">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2020" y="748" />
              <mxPoint x="2020" y="1030" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-45" value="chat 任务" style="whiteSpace=wrap;html=1;fontSize=16;fontFamily=Times New Roman;rounded=1;hachureGap=4;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-117">
          <mxGeometry x="1780" y="175" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-46" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-117" source="nESsYgASZ1RXGsbO0uEQ-13" target="nESsYgASZ1RXGsbO0uEQ-45">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-48" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-117" source="nESsYgASZ1RXGsbO0uEQ-22" target="nESsYgASZ1RXGsbO0uEQ-45">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1645" y="205" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-49" value="sql 任务" style="whiteSpace=wrap;html=1;fontSize=16;fontFamily=Times New Roman;rounded=1;hachureGap=4;labelBackgroundColor=none;" vertex="1" parent="nESsYgASZ1RXGsbO0uEQ-117">
          <mxGeometry x="1780" y="495" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-50" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-117" source="nESsYgASZ1RXGsbO0uEQ-15" target="nESsYgASZ1RXGsbO0uEQ-49">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nESsYgASZ1RXGsbO0uEQ-64" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=16;labelBackgroundColor=none;fontColor=default;" edge="1" parent="nESsYgASZ1RXGsbO0uEQ-117" source="nESsYgASZ1RXGsbO0uEQ-22" target="nESsYgASZ1RXGsbO0uEQ-49">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="Q8_NbCc5938nhFKFAfZ1" name="第 2 页">
    <mxGraphModel dx="923" dy="587" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
